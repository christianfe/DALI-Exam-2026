sequenceDiagram
title Soccorso urbano
autonumber

participant Dispatcher
participant DroneScout
participant AmbulanceUnit
participant FireRescueUnit

alt Segnalazione
  Dispatcher->Dispatcher: incident_report(I, Loc)
else Avvistamento drone
  DroneScout->Dispatcher: incident_spotted(I, Loc)
end

alt Info sufficienti
  Dispatcher->>Dispatcher: classify_incident(I)
else Info insufficienti
  Dispatcher->DroneScout: recon_request(I, Loc)
  DroneScout->Dispatcher: recon_report(I)
end

alt Tipo medico
  Dispatcher->AmbulanceUnit: dispatch(I, Loc)
else Tipo incendio / estricazione
  Dispatcher->FireRescueUnit: dispatch(I, Loc)
end

group Intervento
  alt Richiesta supporto
    AmbulanceUnit->Dispatcher: support_request(I)
    Dispatcher->FireRescueUnit: dispatch(I, Loc)
  else
    FireRescueUnit->Dispatcher: support_request(I)
    Dispatcher->AmbulanceUnit: dispatch(I, Loc)
  end

  AmbulanceUnit->Dispatcher: intervention_complete(I)
  FireRescueUnit->Dispatcher: intervention_complete(I)
  Dispatcher->Dispatcher: close_incident(I)
end
